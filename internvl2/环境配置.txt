先 cd 到 internvl2 目录下
pip install torch==2.0.1 torchvision==0.15.2
pip install -e .
pip install orjson
pip install flash-attn==2.3.6 --no-build-isolation

dpo数据样例
{"prompt": "请详细描述一下这张图片的内容。", "chosen": "这张图片展示了一份临床医学论文的部分内容，标题为“屈肌腱损伤手术中针头临时固定肌腱的改进”。图片中可以看到整齐排列的文字，分为多个段落。每个段落之间有明显的空行，段落的开头有数字标记，表示不同的章节或小节。\n\n第一段落描述了屈肌腱损伤手术中针头临时固定肌腱的改进方法，提到了具体的操作步骤和改进的效果。接下来的段落详细介绍了手术的具体步骤和注意事项，包括术前准备、手术操作和术后护理等内容。\n\n图片的背景为白色，文字为黑色，字体清晰，易于阅读。整篇论文的排版整齐，段落之间的间距适中，便于读者理解和查阅。", "rejected": "这张图片展示的是一张印有大量中文文字的纸张。纸张上印有密密麻麻的文字，内容涉及多个主题，包括但不限于技术、工程和商业领域。文字排列整齐，使用了不同的字体和大小，以突出重点或区分不同的信息块。整体上，这张图片可能用于传达复杂的信息或作为某种技术文档的一部分。", "image_path": "a30b59b601505e0042193a717aaf19d3.jpg"}
{"prompt": "请详细描述一下这张图片的内容。", "chosen": "图片展示了一只轮椅前轮，轮子为8寸实心轮，整体呈现出坚固耐用的外观。轮子的轮辋为黑色，轮胎为灰色，轮辋上有多个辐条，中央有一个金属轴承。轮子下方放置了一根黑色的螺栓和两个黑色的螺母及一个垫圈，显然是用于安装轮子的配件。\n\n图片的背景为浅蓝色，轮子上方和两侧有红色的背景区域，上面用黄色和黑色字体写着“真材实料 加厚 8寸实心轮 满二包邮 送”，下方红色区域用黄色字体写着“适用于各种尺寸一致轮椅”。轮子中央有一张贴纸，上面有一些文字信息，但由于图片分辨率限制，具体内容无法辨认。", "rejected": "这张图片展示了一个汽车轮毂，轮毂主体颜色为白色，边缘部分为黑色。轮毂中心有一个银色的螺栓，周围是黑色的轮辐。在图片的下方，可以看到一个黑色的轮毂轴和两个黑色的轮毂轴承，这些部件位于图片的底部中央。图片的背景是纯白色，使得轮毂和其配件更加突出。整体上，图片传达了一种简洁而专业的汽车配件展示。", "image_path": "2fdea11efb7469657e2084c8d6640bf8.jpg"}
{"prompt": "请详细描述一下这张图片的内容。", "chosen": "图片中展示了一群人在一条红色的步道上行走，背景是一个绿意盎然的户外环境。步道两旁有一些树木和灌木，远处可以看到更多的树木和一些电线杆。\n\n前景中，一位穿着蓝色运动服的女性高举一面红色旗帜，面带微笑，显得非常开心。她的身后是一位穿着深色运动服的男性，手里拿着一个水瓶，似乎也在享受这次活动。再往后，可以看到几位其他的参与者，他们穿着各式各样的运动服，显得非常轻松和愉快。\n\n这张图片捕捉到了天马镇首届绿道健步走活动的一个瞬间，参与者们在春光明媚的日子里，享受着健步走的乐趣。", "rejected": "这张图片展示了一群人在户外跑步的场景。他们位于一条红色的跑道上，背景是郁郁葱葱的树木和电线杆。图中可以看到至少六位跑步者，其中一位女士在跑步时挥舞着一面红色的旗帜。其他跑步者穿着休闲服装，如运动衫和长裤，表情专注，似乎在享受跑步的乐趣。整个场景传达了一种活跃和健康的氛围。", "image_path": "e8320329f4abd52e7e9616165a58b872.jpg"}

[可能需要改]InternVL2 DPO代码注意在 transformer的trainer_utils.py文件中的772行 features = [self._remove_columns(feature) for feature in features] 注释掉！deepspeed==0.13.5
